machine:
  node:
    version: 6.10.2

dependencies:
  override:
    - yarn install:
        pwd:
          server

database:
  override:
    - mysql -u root -e "CREATE DATABASE jsonapi_test"

test:
  override:
    - node_modules/.bin/sequelize db:migrate:
        pwd:
          server
        environment:
          NODE_ENV: test
    - npm test && node_modules/.bin/nyc report --reporter=text-lcov | node_modules/.bin/coveralls:
        pwd:
          server
        environment:
          NODE_ENV: test
          MOCHA_FILE: $CIRCLE_ARTIFACTS/test-results.xml

